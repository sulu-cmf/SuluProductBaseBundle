define(["config"],function(a){"use strict";var b="#product-pricing-form",c="#prices",d=function(){this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/product/template/product/pricing")),h.call(this,this.options.data),e.call(this,this.options.data),j.call(this,!0)},e=function(a){var b={currencies:this.currencies,defaultCurrency:this.defaultCurrency,data:a,el:c};this.sandbox.start([{name:"price-list@suluproduct",options:b}])},f=function(){this.sandbox.on("product.state.change",function(a){this.options.data&&this.options.data.attributes.status&&this.options.data.attributes.status.id===a.id||(this.status=a,this.options.data.attributes.status=this.status,j.call(this,!1))},this),this.sandbox.on("sulu.toolbar.save",function(){g.call(this)},this),this.sandbox.on("sulu.products.saved",function(){j.call(this,!0)},this),this.sandbox.on("sulu.product.set-currencies",function(a){this.currencies=a},this),this.sandbox.on("sulu.product.set-default-currency",function(a){this.defaultCurrency=a},this)},g=function(){if(this.sandbox.form.validate(b)){var a=this.sandbox.form.getData(b);a.status=this.status,this.sandbox.emit("sulu.products.save",a)}},h=function(a){var c=this.sandbox.form.create(b);c.initialized.then(function(){i.call(this,a)}.bind(this))},i=function(a){this.sandbox.form.setData(b,a.toJSON()).then(function(){this.sandbox.start(b)}.bind(this)).fail(function(a){this.sandbox.logger.error("An error occured when setting data!",a)}.bind(this))},j=function(a){a!==this.saved&&(a?this.sandbox.emit("sulu.header.toolbar.item.disable","save",!0):this.sandbox.emit("sulu.header.toolbar.item.enable","save",!1)),this.saved=a},k=function(){this.sandbox.dom.on(b,"change",function(){j.call(this,!1)}.bind(this),'input[type="checkbox"], select'),this.sandbox.dom.on(b,"keyup",function(){j.call(this,!1)}.bind(this),"input, textarea"),this.sandbox.on("sulu.content.changed",function(){j.call(this,!1)}.bind(this)),this.sandbox.on("husky.select.tax-class.selected.item",function(){j.call(this,!1)}.bind(this))};return{name:"Sulu Product Pricing View",view:!0,templates:["/admin/product/template/product/pricing"],initialize:function(){this.options.data?this.status=this.options.data.attributes.status:this.status=a.get("product.status.inactive"),this.sandbox.emit("product.state.change",this.status),f.call(this),d.call(this),k.call(this)}}});